<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>	오늘, 괜찮았나요? 🌱</title>
  <style>
    body {
      font-family: 'Noto Sans KR', sans-serif;
      background-color: #fef8f8;
      background-image: url('https://i.ibb.co/MyLm7bWJ/Chat-GPT-Image-2025-4-18-12-01-33.png');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      background-color: #fef8f8;
      color: #333;
      text-align: center;
      padding: 50px;
    }
    .box {
      background: rgba(255, 255, 255, 0.92);
      padding: 30px;
      border-radius: 20px;
      max-width: 600px;
      margin: auto;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }
    h1 {
      font-size: 1.8rem;
      margin-bottom: 10px;
    }
    .weather {
      font-size: 1.1rem;
      margin-bottom: 25px;
      line-height: 1.6;
    }
    .content {
      text-align: left;
      font-size: 1rem;
      margin-top: 30px;
    }
    .content p {
      margin: 8px 0;
    }
  </style>
</head>
<body>
  <div class="box">
    <h1>🌸 오늘의 감정, 나를 위한 루틴 🌼</h1>
    <div id="weather" class="weather">날씨 정보를 불러오는 중...</div>
    <div id="content" class="content"></div>
  </div>

  <script>
    const apiKey = "ae2dd5af466f227db77a00f5aac8972d"; 

    const contentByWeather = {
      clear: {
        운동: ["러닝 20분 + 스트레칭", "공원 산책", "요가 루틴", "자전거 타기", "댄스 다이어트 영상 따라하기"],
        음악: ["빌리 아일리시 – My Future", "선우정아 – 도망가자"],
        음식: ["시리얼 + 과일 + 요거트", "샐러드 + 닭가슴살", "아보카도 오픈 샌드위치", "과일 주스", "그릭요거트볼"],
        색: ["노란색", "하늘색", "연두색", "라벤더", "민트"],
        운세: [
          "오늘은 당신이 빛나는 날이에요.",
          "새로운 기회를 잡을 좋은 날이에요.",
          "기분 좋은 일이 생길 운세!",
          "에너지를 표현해보세요.",
          "웃는 얼굴에 복이 와요 :)"
        ],
        감사일기: ["오늘 하늘을 본 순간", "걷는 동안의 기분", "따뜻한 햇살"]
      },
      rain: {
        운동: ["실내 요가 + 명상", "전신 스트레칭", "필라테스", "홈트 10분", "계단 오르기"],
        음악: ["이소라 – 바람이 분다", "아이유 – Rain Drop", "백예린 – Bye bye my blue"],
        음식: ["우동", "감자전 + 막걸리", "바나나우유와 쿠키", "스프 + 토스트", "카레라이스"],
        색: ["남색", "진회색", "청록", "와인색", "흰색"],
        운세: [
          "감정을 그대로 느껴도 괜찮아요.",
          "잠깐의 여유가 회복을 줘요.",
          "오늘은 무리하지 말아요.",
          "비 오는 날엔 내면을 돌아봐요."
        ],
        감사일기: ["차 한잔 마신 여유", "창밖 풍경", "조용한 시간"]
      }
    };

    const icons = {
      운동: "💪 운동",
      음악: "🎧 음악",
      음식: "🍽 음식",
      색: "🎨 행운의 색",
      운세: "🔮 오늘의 운세",
      감사일기: "📓 감사일기 제안"
    };

    function pickRandom(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function pickRandomKeys(obj, count) {
      const keys = Object.keys(obj);
      const shuffled = keys.sort(() => 0.5 - Math.random());
      return shuffled.slice(0, count);
    }

    async function getWeather(lat, lon) {
      const res = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${apiKey}&lang=kr`);
      return await res.json();
    }

    navigator.geolocation.getCurrentPosition(async (pos) => {
      const { latitude, longitude } = pos.coords;
      try {
        const data = await getWeather(latitude, longitude);
        const weatherCode = data.weather[0].main.toLowerCase();
        const tempC = (data.main.temp - 273.15).toFixed(1);
        const city = data.name || "현재 위치";

        document.getElementById("weather").innerHTML =
          `📍 ${city} | ${data.weather[0].description} | ${tempC}°C`;

        const categorySet = contentByWeather[weatherCode] || contentByWeather["clear"];
        const pickedCategories = pickRandomKeys(categorySet, 3);
        const container = document.getElementById("content");

        pickedCategories.forEach(cat => {
          const value = pickRandom(categorySet[cat]);
          container.innerHTML += `<p><strong>${icons[cat]}:</strong> ${value}</p>`;
        });

      } catch {
        document.getElementById("weather").innerText = "날씨 정보를 불러오지 못했어요 😢";
      }
    }, () => {
      document.getElementById("weather").innerText = "위치 정보 사용이 차단되어 있어요.";
    });
  </script>
</body>
</html>
